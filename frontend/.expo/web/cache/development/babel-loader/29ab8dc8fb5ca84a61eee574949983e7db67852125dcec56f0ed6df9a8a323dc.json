{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useEffect, useRef } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { Text, Button, TextInput, Card, IconButton, Snackbar } from 'react-native-paper';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { supabase } from \"../lib/supabase\";\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport Animated, { FadeIn, Layout, SlideOutRight } from 'react-native-reanimated';\nimport { GestureHandlerRootView, Swipeable } from 'react-native-gesture-handler';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar chatIcon = require(\"../assets/chat-icon.png\");\nvar archiveIcon = require(\"../assets/archive-icon.png\");\nexport default function Home() {\n  var navigation = useNavigation();\n  var _useState = useState(true),\n    _useState2 = _slicedToArray(_useState, 2),\n    showHistory = _useState2[0],\n    setShowHistory = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    searchQuery = _useState4[0],\n    setSearchQuery = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    chats = _useState6[0],\n    setChats = _useState6[1];\n  var _useState7 = useState([]),\n    _useState8 = _slicedToArray(_useState7, 2),\n    archivedChats = _useState8[0],\n    setArchivedChats = _useState8[1];\n  var _useState9 = useState(true),\n    _useState10 = _slicedToArray(_useState9, 2),\n    loading = _useState10[0],\n    setLoading = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    snackbarVisible = _useState12[0],\n    setSnackbarVisible = _useState12[1];\n  var _useState13 = useState(''),\n    _useState14 = _slicedToArray(_useState13, 2),\n    snackbarMessage = _useState14[0],\n    setSnackbarMessage = _useState14[1];\n  var searchWidth = useRef(new Animated.Value(40)).current;\n  var pathOpacity = useRef(new Animated.Value(1)).current;\n  var pathScale = useRef(new Animated.Value(1)).current;\n  useEffect(function () {\n    var _animate = function animate() {\n      Animated.sequence([Animated.parallel([Animated.timing(pathOpacity, {\n        toValue: 0.5,\n        duration: 1000,\n        useNativeDriver: true\n      }), Animated.timing(pathScale, {\n        toValue: 1.1,\n        duration: 1000,\n        useNativeDriver: true\n      })]), Animated.parallel([Animated.timing(pathOpacity, {\n        toValue: 1,\n        duration: 1000,\n        useNativeDriver: true\n      }), Animated.timing(pathScale, {\n        toValue: 1,\n        duration: 1000,\n        useNativeDriver: true\n      })])]).start(function () {\n        return _animate();\n      });\n    };\n    _animate();\n  }, []);\n  var toggleSearch = function toggleSearch() {\n    Animated.timing(searchWidth, {\n      toValue: searchWidth._value === 40 ? 200 : 40,\n      duration: 300,\n      useNativeDriver: false\n    }).start();\n  };\n  useFocusEffect(React.useCallback(function () {\n    loadChats();\n  }, []));\n  var handleLogout = function () {\n    var _ref = _asyncToGenerator(function* () {\n      try {\n        yield supabase.auth.signOut();\n        navigation.navigate('Login');\n      } catch (error) {\n        console.error('Error logging out:', error);\n      }\n    });\n    return function handleLogout() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var loadChats = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        setLoading(true);\n        var _yield$supabase$auth$ = yield supabase.auth.getUser(),\n          user = _yield$supabase$auth$.data.user;\n        if (!user) {\n          console.error('No user found');\n          navigation.navigate('Login');\n          return;\n        }\n        console.log('Loading chats for user:', user.id);\n        var _yield$supabase$from$ = yield supabase.from('chats').select('*').limit(1),\n          tableInfo = _yield$supabase$from$.data,\n          tableError = _yield$supabase$from$.error;\n        if (tableError) {\n          console.error('Error checking table:', tableError);\n          return;\n        }\n        console.log('Table structure:', tableInfo);\n        var _yield$supabase$from$2 = yield supabase.from('chats').select(`\n          id,\n          user_id,\n          question,\n          response,\n          created_at,\n          is_archived\n        `).eq('user_id', user.id).order('created_at', {\n            ascending: false\n          }),\n          chatData = _yield$supabase$from$2.data,\n          error = _yield$supabase$from$2.error;\n        if (error) {\n          console.error('Error loading chats:', error);\n          return;\n        }\n        console.log('Loaded chats:', chatData);\n        if (!chatData) {\n          console.log('No chat data returned');\n          setChats([]);\n          setArchivedChats([]);\n          return;\n        }\n        var processedChats = chatData.map(function (chat) {\n          return _objectSpread(_objectSpread({}, chat), {}, {\n            response: typeof chat.response === 'string' ? JSON.parse(chat.response) : chat.response\n          });\n        });\n        console.log('Processed chats:', processedChats);\n        setChats(processedChats.filter(function (chat) {\n          return !chat.is_archived;\n        }));\n        setArchivedChats(processedChats.filter(function (chat) {\n          return chat.is_archived;\n        }));\n      } catch (error) {\n        console.error('Error in loadChats:', error);\n      } finally {\n        setLoading(false);\n      }\n    });\n    return function loadChats() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var handleArchiveToggle = function () {\n    var _ref3 = _asyncToGenerator(function* (chatId, currentlyArchived) {\n      try {\n        var _yield$supabase$from$3 = yield supabase.from('chats').update({\n            is_archived: !currentlyArchived\n          }).eq('id', chatId),\n          error = _yield$supabase$from$3.error;\n        if (error) {\n          console.error('Error toggling archive status:', error);\n          return;\n        }\n        loadChats();\n      } catch (error) {\n        console.error('Error in handleArchiveToggle:', error);\n      }\n    });\n    return function handleArchiveToggle(_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var handleDelete = function () {\n    var _ref4 = _asyncToGenerator(function* (chatId) {\n      try {\n        var _yield$supabase$from$4 = yield supabase.from('chats').delete().eq('id', chatId),\n          error = _yield$supabase$from$4.error;\n        if (error) {\n          throw new Error('Error deleting chat');\n        }\n        setSnackbarMessage('Chat deleted successfully');\n        setSnackbarVisible(true);\n        loadChats();\n      } catch (error) {\n        console.error('Error deleting chat:', error);\n        setSnackbarMessage('Failed to delete chat');\n        setSnackbarVisible(true);\n      }\n    });\n    return function handleDelete(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var confirmDelete = function confirmDelete(chatId) {\n    Alert.alert('Delete Chat', 'Are you sure you want to delete this chat? This action cannot be undone.', [{\n      text: 'Cancel',\n      style: 'cancel'\n    }, {\n      text: 'Delete',\n      onPress: function onPress() {\n        return handleDelete(chatId);\n      },\n      style: 'destructive'\n    }]);\n  };\n  var _renderRightActions = function renderRightActions(chatId) {\n    return _jsx(TouchableOpacity, {\n      style: styles.deleteButton,\n      onPress: function onPress() {\n        return confirmDelete(chatId);\n      },\n      children: _jsx(MaterialCommunityIcons, {\n        name: \"delete\",\n        size: 24,\n        color: \"#fff\"\n      })\n    });\n  };\n  var filteredChats = (showHistory ? chats : archivedChats).filter(function (chat) {\n    return chat.question.toLowerCase().includes(searchQuery.toLowerCase());\n  });\n  var renderChatItem = function renderChatItem(chat) {\n    return _jsx(Animated.View, {\n      entering: FadeIn,\n      exiting: SlideOutRight,\n      layout: Layout.springify(),\n      children: _jsx(Swipeable, {\n        renderRightActions: function renderRightActions() {\n          return _renderRightActions(chat.id);\n        },\n        overshootRight: false,\n        children: _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return navigation.navigate('Response', {\n              question: chat.question,\n              verse: chat.response.verse,\n              reference: chat.response.reference,\n              relevance: chat.response.relevance,\n              explanation: chat.response.explanation\n            });\n          },\n          children: _jsxs(Card, {\n            style: styles.historyCard,\n            children: [_jsxs(View, {\n              style: styles.historyCardHeader,\n              children: [_jsx(Text, {\n                style: styles.historyCardTitle,\n                children: chat.question\n              }), _jsx(IconButton, {\n                icon: chat.is_archived ? 'archive-remove' : 'archive',\n                size: 24,\n                onPress: function onPress() {\n                  return handleArchiveToggle(chat.id, chat.is_archived);\n                }\n              })]\n            }), _jsxs(Text, {\n              style: styles.historyCardContent,\n              children: [chat.response.verse, \" - \", chat.response.reference]\n            }), _jsx(Text, {\n              style: styles.historyCardTime,\n              children: new Date(chat.created_at).toLocaleDateString()\n            })]\n          })\n        })\n      })\n    }, chat.id);\n  };\n  return _jsx(GestureHandlerRootView, {\n    style: {\n      flex: 1\n    },\n    children: _jsxs(SafeAreaView, {\n      style: styles.container,\n      children: [_jsx(ScrollView, {\n        contentContainerStyle: styles.scrollContent,\n        children: _jsxs(View, {\n          style: styles.content,\n          children: [_jsx(Image, {\n            source: require(\"../assets/logo-full.png\"),\n            style: styles.logo,\n            resizeMode: \"contain\"\n          }), _jsx(View, {\n            style: styles.titleContainer,\n            children: _jsxs(Text, {\n              style: styles.mainTitle,\n              children: [\"Seek Your Verse, Find Your\", ' ', _jsx(Animated.Text, {\n                style: [styles.mainTitle, styles.highlight, {\n                  opacity: pathOpacity,\n                  transform: [{\n                    scale: pathScale\n                  }]\n                }],\n                children: \"Path\"\n              })]\n            })\n          }), _jsx(TouchableOpacity, {\n            style: styles.newTopicButton,\n            onPress: function onPress() {\n              return navigation.navigate('Question');\n            },\n            children: _jsx(Text, {\n              style: styles.newTopicText,\n              children: \"+ New Topic\"\n            })\n          }), _jsxs(View, {\n            style: styles.historySection,\n            children: [_jsxs(View, {\n              style: styles.historyHeader,\n              children: [_jsxs(View, {\n                style: styles.toggleContainer,\n                children: [_jsx(TouchableOpacity, {\n                  style: [styles.toggleButton, showHistory && styles.activeToggle],\n                  onPress: function onPress() {\n                    return setShowHistory(true);\n                  },\n                  children: _jsx(Text, {\n                    style: [styles.toggleText, showHistory && styles.activeToggleText],\n                    children: \"Chats\"\n                  })\n                }), _jsx(TouchableOpacity, {\n                  style: [styles.toggleButton, !showHistory && styles.activeToggle],\n                  onPress: function onPress() {\n                    return setShowHistory(false);\n                  },\n                  children: _jsx(Text, {\n                    style: [styles.toggleText, !showHistory && styles.activeToggleText],\n                    children: \"Archived\"\n                  })\n                })]\n              }), _jsxs(Animated.View, {\n                style: [styles.searchContainer, {\n                  width: searchWidth,\n                  flexDirection: 'row',\n                  alignItems: 'center'\n                }],\n                children: [_jsx(TouchableOpacity, {\n                  onPress: toggleSearch,\n                  children: _jsx(MaterialCommunityIcons, {\n                    name: \"magnify\",\n                    size: 24,\n                    color: \"#fff\"\n                  })\n                }), _jsx(Animated.View, {\n                  style: {\n                    flex: 1,\n                    overflow: 'hidden',\n                    width: searchWidth\n                  },\n                  children: _jsx(TextInput, {\n                    style: styles.searchInput,\n                    placeholder: \"Search history...\",\n                    value: searchQuery,\n                    onChangeText: setSearchQuery,\n                    placeholderTextColor: \"#666\"\n                  })\n                })]\n              })]\n            }), loading ? _jsx(Text, {\n              style: styles.loadingText,\n              children: \"Loading your conversations...\"\n            }) : filteredChats.length === 0 ? _jsx(Text, {\n              style: styles.emptyText,\n              children: showHistory ? \"No chat history yet. Start a new topic!\" : \"No archived chats yet.\"\n            }) : _jsx(View, {\n              style: styles.historyCards,\n              children: filteredChats.map(renderChatItem)\n            })]\n          }), _jsx(Button, {\n            mode: \"outlined\",\n            onPress: handleLogout,\n            style: styles.logoutButton,\n            children: \"Logout\"\n          })]\n        })\n      }), _jsx(Snackbar, {\n        visible: snackbarVisible,\n        onDismiss: function onDismiss() {\n          return setSnackbarVisible(false);\n        },\n        duration: 2000,\n        children: snackbarMessage\n      })]\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#000000'\n  },\n  content: {\n    flex: 1,\n    padding: 20\n  },\n  scrollContent: {\n    flexGrow: 1\n  },\n  logo: {\n    width: '100%',\n    height: 159,\n    marginTop: 20,\n    marginBottom: 30\n  },\n  titleContainer: {\n    marginBottom: 32\n  },\n  mainTitle: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 24,\n    color: '#FFFFFF',\n    textAlign: 'center',\n    lineHeight: 32,\n    fontWeight: '400'\n  },\n  highlight: {\n    color: '#FFD9D0'\n  },\n  newTopicButton: {\n    backgroundColor: 'rgba(255, 255, 255, 0.05)',\n    borderRadius: 12,\n    padding: 20,\n    marginBottom: 40,\n    alignItems: 'center'\n  },\n  newTopicText: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 16,\n    color: '#FFD9D0',\n    fontWeight: '400'\n  },\n  historySection: {\n    flex: 1\n  },\n  historyHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 16,\n    paddingHorizontal: 16\n  },\n  toggleContainer: {\n    flexDirection: 'row',\n    backgroundColor: '#1a1a1a',\n    borderRadius: 25,\n    padding: 4\n  },\n  toggleButton: {\n    paddingVertical: 8,\n    paddingHorizontal: 16,\n    borderRadius: 20\n  },\n  activeToggle: {\n    backgroundColor: '#333'\n  },\n  toggleText: {\n    color: '#666',\n    fontSize: 14,\n    fontWeight: '500'\n  },\n  activeToggleText: {\n    color: '#fff'\n  },\n  searchContainer: {\n    backgroundColor: '#1a1a1a',\n    borderRadius: 25,\n    padding: 8,\n    overflow: 'hidden'\n  },\n  searchInput: {\n    backgroundColor: 'transparent',\n    paddingHorizontal: 10,\n    color: '#fff',\n    height: 40\n  },\n  historyCard: {\n    backgroundColor: 'rgba(255, 255, 255, 0.05)',\n    marginBottom: 16,\n    borderRadius: 12\n  },\n  historyCardHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    padding: 16\n  },\n  historyCardTitle: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 16,\n    color: '#FFFFFF',\n    flex: 1,\n    marginRight: 16,\n    fontWeight: '400',\n    lineHeight: 22\n  },\n  historyCardContent: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 14,\n    color: 'rgba(255, 255, 255, 0.7)',\n    paddingHorizontal: 16,\n    paddingBottom: 12,\n    lineHeight: 20,\n    fontWeight: '400'\n  },\n  historyCardTime: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 12,\n    color: 'rgba(255, 255, 255, 0.5)',\n    paddingHorizontal: 16,\n    paddingBottom: 16,\n    fontWeight: '400'\n  },\n  historyCards: {\n    marginTop: 20\n  },\n  loadingText: {\n    color: '#666666',\n    textAlign: 'center',\n    marginTop: 20,\n    fontSize: 16\n  },\n  emptyText: {\n    color: '#666666',\n    textAlign: 'center',\n    marginTop: 20,\n    fontSize: 16\n  },\n  logoutButton: {\n    marginTop: 20,\n    borderColor: '#FFD9D0'\n  },\n  deleteButton: {\n    backgroundColor: '#FF4444',\n    justifyContent: 'center',\n    alignItems: 'center',\n    width: 80,\n    height: '100%'\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","useRef","StyleSheet","View","ScrollView","TouchableOpacity","Image","Alert","Text","Button","TextInput","Card","IconButton","Snackbar","SafeAreaView","useNavigation","useFocusEffect","supabase","MaterialCommunityIcons","Animated","FadeIn","Layout","SlideOutRight","GestureHandlerRootView","Swipeable","jsx","_jsx","jsxs","_jsxs","chatIcon","require","archiveIcon","Home","navigation","_useState","_useState2","_slicedToArray","showHistory","setShowHistory","_useState3","_useState4","searchQuery","setSearchQuery","_useState5","_useState6","chats","setChats","_useState7","_useState8","archivedChats","setArchivedChats","_useState9","_useState10","loading","setLoading","_useState11","_useState12","snackbarVisible","setSnackbarVisible","_useState13","_useState14","snackbarMessage","setSnackbarMessage","searchWidth","Value","current","pathOpacity","pathScale","animate","sequence","parallel","timing","toValue","duration","useNativeDriver","start","toggleSearch","_value","useCallback","loadChats","handleLogout","_ref","_asyncToGenerator","auth","signOut","navigate","error","console","apply","arguments","_ref2","_yield$supabase$auth$","getUser","user","data","log","id","_yield$supabase$from$","from","select","limit","tableInfo","tableError","_yield$supabase$from$2","eq","order","ascending","chatData","processedChats","map","chat","_objectSpread","response","JSON","parse","filter","is_archived","handleArchiveToggle","_ref3","chatId","currentlyArchived","_yield$supabase$from$3","update","_x","_x2","handleDelete","_ref4","_yield$supabase$from$4","delete","Error","_x3","confirmDelete","alert","text","style","onPress","renderRightActions","styles","deleteButton","children","name","size","color","filteredChats","question","toLowerCase","includes","renderChatItem","entering","exiting","layout","springify","overshootRight","verse","reference","relevance","explanation","historyCard","historyCardHeader","historyCardTitle","icon","historyCardContent","historyCardTime","Date","created_at","toLocaleDateString","flex","container","contentContainerStyle","scrollContent","content","source","logo","resizeMode","titleContainer","mainTitle","highlight","opacity","transform","scale","newTopicButton","newTopicText","historySection","historyHeader","toggleContainer","toggleButton","activeToggle","toggleText","activeToggleText","searchContainer","width","flexDirection","alignItems","overflow","searchInput","placeholder","value","onChangeText","placeholderTextColor","loadingText","length","emptyText","historyCards","mode","logoutButton","visible","onDismiss","create","backgroundColor","padding","flexGrow","height","marginTop","marginBottom","fontFamily","fontSize","textAlign","lineHeight","fontWeight","borderRadius","justifyContent","paddingHorizontal","paddingVertical","marginRight","paddingBottom","borderColor"],"sources":["d:/CODING/random/12-13/bible_verse_app/frontend/pages/Home.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { StyleSheet, View, ScrollView, TouchableOpacity, Image, Animated as RNAnimated, Dimensions, Alert } from 'react-native';\nimport { Text, Button, TextInput, Card, IconButton, Snackbar } from 'react-native-paper';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { supabase } from '../lib/supabase';\nimport { NavigationProps } from '../navigation.types';\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport Animated, {\n  FadeIn,\n  FadeOut,\n  Layout,\n  SlideOutRight,\n} from 'react-native-reanimated';\nimport { GestureHandlerRootView, Swipeable } from 'react-native-gesture-handler';\n\n// Import icons\nconst chatIcon = require('../assets/chat-icon.png');\nconst archiveIcon = require('../assets/archive-icon.png');\n\ninterface ChatItem {\n  id: string;\n  question: string;\n  response: {\n    verse: string;\n    reference: string;\n    relevance: string;\n    explanation: string;\n  };\n  created_at: string;\n  is_archived: boolean;\n}\n\nexport default function Home() {\n  const navigation = useNavigation<NavigationProps>();\n  const [showHistory, setShowHistory] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [chats, setChats] = useState<ChatItem[]>([]);\n  const [archivedChats, setArchivedChats] = useState<ChatItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [snackbarVisible, setSnackbarVisible] = useState(false);\n  const [snackbarMessage, setSnackbarMessage] = useState('');\n\n  const searchWidth = useRef(new Animated.Value(40)).current;\n  const pathOpacity = useRef(new Animated.Value(1)).current;\n  const pathScale = useRef(new Animated.Value(1)).current;\n\n  useEffect(() => {\n    const animate = () => {\n      Animated.sequence([\n        Animated.parallel([\n          Animated.timing(pathOpacity, {\n            toValue: 0.5,\n            duration: 1000,\n            useNativeDriver: true,\n          }),\n          Animated.timing(pathScale, {\n            toValue: 1.1,\n            duration: 1000,\n            useNativeDriver: true,\n          }),\n        ]),\n        Animated.parallel([\n          Animated.timing(pathOpacity, {\n            toValue: 1,\n            duration: 1000,\n            useNativeDriver: true,\n          }),\n          Animated.timing(pathScale, {\n            toValue: 1,\n            duration: 1000,\n            useNativeDriver: true,\n          }),\n        ]),\n      ]).start(() => animate());\n    };\n\n    animate();\n  }, []);\n\n  const toggleSearch = () => {\n    Animated.timing(searchWidth, {\n      toValue: searchWidth._value === 40 ? 200 : 40,\n      duration: 300,\n      useNativeDriver: false,\n    }).start();\n  };\n\n  // Load chats when the screen comes into focus\n  useFocusEffect(\n    React.useCallback(() => {\n      loadChats();\n    }, [])\n  );\n\n  const handleLogout = async () => {\n    try {\n      await supabase.auth.signOut();\n      navigation.navigate('Login');\n    } catch (error) {\n      console.error('Error logging out:', error);\n    }\n  };\n\n  const loadChats = async () => {\n    try {\n      setLoading(true);\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) {\n        console.error('No user found');\n        navigation.navigate('Login');\n        return;\n      }\n\n      console.log('Loading chats for user:', user.id);\n\n      // First, check if the table exists and has the correct structure\n      const { data: tableInfo, error: tableError } = await supabase\n        .from('chats')\n        .select('*')\n        .limit(1);\n\n      if (tableError) {\n        console.error('Error checking table:', tableError);\n        return;\n      }\n\n      console.log('Table structure:', tableInfo);\n\n      // Now fetch the actual chats with all fields explicitly specified\n      const { data: chatData, error } = await supabase\n        .from('chats')\n        .select(`\n          id,\n          user_id,\n          question,\n          response,\n          created_at,\n          is_archived\n        `)\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false });\n\n      if (error) {\n        console.error('Error loading chats:', error);\n        return;\n      }\n\n      console.log('Loaded chats:', chatData);\n\n      if (!chatData) {\n        console.log('No chat data returned');\n        setChats([]);\n        setArchivedChats([]);\n        return;\n      }\n\n      // Parse the response field if it's stored as a string\n      const processedChats = chatData.map(chat => ({\n        ...chat,\n        response: typeof chat.response === 'string' \n          ? JSON.parse(chat.response)\n          : chat.response\n      }));\n\n      console.log('Processed chats:', processedChats);\n\n      setChats(processedChats.filter(chat => !chat.is_archived));\n      setArchivedChats(processedChats.filter(chat => chat.is_archived));\n    } catch (error) {\n      console.error('Error in loadChats:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleArchiveToggle = async (chatId: string, currentlyArchived: boolean) => {\n    try {\n      const { error } = await supabase\n        .from('chats')\n        .update({ is_archived: !currentlyArchived })\n        .eq('id', chatId);\n\n      if (error) {\n        console.error('Error toggling archive status:', error);\n        return;\n      }\n\n      // Reload chats after updating\n      loadChats();\n    } catch (error) {\n      console.error('Error in handleArchiveToggle:', error);\n    }\n  };\n\n  const handleDelete = async (chatId: string) => {\n    try {\n      const { error } = await supabase\n        .from('chats')\n        .delete()\n        .eq('id', chatId);\n\n      if (error) {\n        throw new Error('Error deleting chat');\n      }\n\n      setSnackbarMessage('Chat deleted successfully');\n      setSnackbarVisible(true);\n      loadChats();\n    } catch (error) {\n      console.error('Error deleting chat:', error);\n      setSnackbarMessage('Failed to delete chat');\n      setSnackbarVisible(true);\n    }\n  };\n\n  const confirmDelete = (chatId: string) => {\n    Alert.alert(\n      'Delete Chat',\n      'Are you sure you want to delete this chat? This action cannot be undone.',\n      [\n        {\n          text: 'Cancel',\n          style: 'cancel',\n        },\n        {\n          text: 'Delete',\n          onPress: () => handleDelete(chatId),\n          style: 'destructive',\n        },\n      ],\n    );\n  };\n\n  const renderRightActions = (chatId: string) => {\n    return (\n      <TouchableOpacity\n        style={styles.deleteButton}\n        onPress={() => confirmDelete(chatId)}\n      >\n        <MaterialCommunityIcons name=\"delete\" size={24} color=\"#fff\" />\n      </TouchableOpacity>\n    );\n  };\n\n  const filteredChats = (showHistory ? chats : archivedChats).filter(chat =>\n    chat.question.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const renderChatItem = (chat: ChatItem) => (\n    <Animated.View\n      key={chat.id}\n      entering={FadeIn}\n      exiting={SlideOutRight}\n      layout={Layout.springify()}\n    >\n      <Swipeable\n        renderRightActions={() => renderRightActions(chat.id)}\n        overshootRight={false}\n      >\n        <TouchableOpacity\n          onPress={() => navigation.navigate('Response', {\n            question: chat.question,\n            verse: chat.response.verse,\n            reference: chat.response.reference,\n            relevance: chat.response.relevance,\n            explanation: chat.response.explanation\n          })}\n        >\n          <Card style={styles.historyCard}>\n            <View style={styles.historyCardHeader}>\n              <Text style={styles.historyCardTitle}>{chat.question}</Text>\n              <IconButton\n                icon={chat.is_archived ? 'archive-remove' : 'archive'}\n                size={24}\n                onPress={() => handleArchiveToggle(chat.id, chat.is_archived)}\n              />\n            </View>\n            <Text style={styles.historyCardContent}>\n              {chat.response.verse} - {chat.response.reference}\n            </Text>\n            <Text style={styles.historyCardTime}>\n              {new Date(chat.created_at).toLocaleDateString()}\n            </Text>\n          </Card>\n        </TouchableOpacity>\n      </Swipeable>\n    </Animated.View>\n  );\n\n  return (\n    <GestureHandlerRootView style={{ flex: 1 }}>\n      <SafeAreaView style={styles.container}>\n        <ScrollView contentContainerStyle={styles.scrollContent}>\n          <View style={styles.content}>\n            <Image \n              source={require('../assets/logo-full.png')} \n              style={styles.logo} \n              resizeMode=\"contain\"\n            />\n\n            <View style={styles.titleContainer}>\n              <Text style={styles.mainTitle}>\n                Seek Your Verse, Find Your{' '}\n                <Animated.Text \n                  style={[\n                    styles.mainTitle, \n                    styles.highlight,\n                    {\n                      opacity: pathOpacity,\n                      transform: [{ scale: pathScale }]\n                    }\n                  ]}\n                >\n                  Path\n                </Animated.Text>\n              </Text>\n            </View>\n\n            <TouchableOpacity \n              style={styles.newTopicButton} \n              onPress={() => navigation.navigate('Question')}\n            >\n              <Text style={styles.newTopicText}>+ New Topic</Text>\n            </TouchableOpacity>\n\n            <View style={styles.historySection}>\n              <View style={styles.historyHeader}>\n                <View style={styles.toggleContainer}>\n                  <TouchableOpacity\n                    style={[\n                      styles.toggleButton,\n                      showHistory && styles.activeToggle\n                    ]}\n                    onPress={() => setShowHistory(true)}\n                  >\n                    <Text style={[\n                      styles.toggleText,\n                      showHistory && styles.activeToggleText\n                    ]}>Chats</Text>\n                  </TouchableOpacity>\n                  <TouchableOpacity\n                    style={[\n                      styles.toggleButton,\n                      !showHistory && styles.activeToggle\n                    ]}\n                    onPress={() => setShowHistory(false)}\n                  >\n                    <Text style={[\n                      styles.toggleText,\n                      !showHistory && styles.activeToggleText\n                    ]}>Archived</Text>\n                  </TouchableOpacity>\n                </View>\n                <Animated.View style={[styles.searchContainer, {\n                  width: searchWidth,\n                  flexDirection: 'row',\n                  alignItems: 'center',\n                }]}>\n                  <TouchableOpacity onPress={toggleSearch}>\n                    <MaterialCommunityIcons name=\"magnify\" size={24} color=\"#fff\" />\n                  </TouchableOpacity>\n                  <Animated.View style={{ flex: 1, overflow: 'hidden', width: searchWidth }}>\n                    <TextInput\n                      style={styles.searchInput}\n                      placeholder=\"Search history...\"\n                      value={searchQuery}\n                      onChangeText={setSearchQuery}\n                      placeholderTextColor=\"#666\"\n                    />\n                  </Animated.View>\n                </Animated.View>\n              </View>\n\n              {loading ? (\n                <Text style={styles.loadingText}>Loading your conversations...</Text>\n              ) : filteredChats.length === 0 ? (\n                <Text style={styles.emptyText}>\n                  {showHistory \n                    ? \"No chat history yet. Start a new topic!\" \n                    : \"No archived chats yet.\"}\n                </Text>\n              ) : (\n                <View style={styles.historyCards}>\n                  {filteredChats.map(renderChatItem)}\n                </View>\n              )}\n            </View>\n\n            <Button mode=\"outlined\" onPress={handleLogout} style={styles.logoutButton}>\n              Logout\n            </Button>\n          </View>\n        </ScrollView>\n        <Snackbar\n          visible={snackbarVisible}\n          onDismiss={() => setSnackbarVisible(false)}\n          duration={2000}\n        >\n          {snackbarMessage}\n        </Snackbar>\n      </SafeAreaView>\n    </GestureHandlerRootView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#000000',\n  },\n  content: {\n    flex: 1,\n    padding: 20,\n  },\n  scrollContent: {\n    flexGrow: 1,\n  },\n  logo: {\n    width: '100%',\n    height: 159,\n    marginTop: 20,\n    marginBottom: 30,\n  },\n  titleContainer: {\n    marginBottom: 32,\n  },\n  mainTitle: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 24,\n    color: '#FFFFFF',\n    textAlign: 'center',\n    lineHeight: 32,\n    fontWeight: '400',\n  },\n  highlight: {\n    color: '#FFD9D0',\n  },\n  newTopicButton: {\n    backgroundColor: 'rgba(255, 255, 255, 0.05)',\n    borderRadius: 12,\n    padding: 20,\n    marginBottom: 40,\n    alignItems: 'center',\n  },\n  newTopicText: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 16,\n    color: '#FFD9D0',\n    fontWeight: '400',\n  },\n  historySection: {\n    flex: 1,\n  },\n  historyHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 16,\n    paddingHorizontal: 16,\n  },\n  toggleContainer: {\n    flexDirection: 'row',\n    backgroundColor: '#1a1a1a',\n    borderRadius: 25,\n    padding: 4,\n  },\n  toggleButton: {\n    paddingVertical: 8,\n    paddingHorizontal: 16,\n    borderRadius: 20,\n  },\n  activeToggle: {\n    backgroundColor: '#333',\n  },\n  toggleText: {\n    color: '#666',\n    fontSize: 14,\n    fontWeight: '500',\n  },\n  activeToggleText: {\n    color: '#fff',\n  },\n  searchContainer: {\n    backgroundColor: '#1a1a1a',\n    borderRadius: 25,\n    padding: 8,\n    overflow: 'hidden',\n  },\n  searchInput: {\n    backgroundColor: 'transparent',\n    paddingHorizontal: 10,\n    color: '#fff',\n    height: 40,\n  },\n  historyCard: {\n    backgroundColor: 'rgba(255, 255, 255, 0.05)',\n    marginBottom: 16,\n    borderRadius: 12,\n  },\n  historyCardHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-start',\n    padding: 16,\n  },\n  historyCardTitle: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 16,\n    color: '#FFFFFF',\n    flex: 1,\n    marginRight: 16,\n    fontWeight: '400',\n    lineHeight: 22,\n  },\n  historyCardContent: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 14,\n    color: 'rgba(255, 255, 255, 0.7)',\n    paddingHorizontal: 16,\n    paddingBottom: 12,\n    lineHeight: 20,\n    fontWeight: '400',\n  },\n  historyCardTime: {\n    fontFamily: 'SF Pro Display',\n    fontSize: 12,\n    color: 'rgba(255, 255, 255, 0.5)',\n    paddingHorizontal: 16,\n    paddingBottom: 16,\n    fontWeight: '400',\n  },\n  historyCards: {\n    marginTop: 20,\n  },\n  loadingText: {\n    color: '#666666',\n    textAlign: 'center',\n    marginTop: 20,\n    fontSize: 16,\n  },\n  emptyText: {\n    color: '#666666',\n    textAlign: 'center',\n    marginTop: 20,\n    fontSize: 16,\n  },\n  logoutButton: {\n    marginTop: 20,\n    borderColor: '#FFD9D0',\n  },\n  deleteButton: {\n    backgroundColor: '#FF4444',\n    justifyContent: 'center',\n    alignItems: 'center',\n    width: 80,\n    height: '100%',\n  },\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}